{% extends 'base.html' %}
{% block title %}Setlist - {{ concert.artist.name }}{% endblock %}
{% block content %}
<div class="p-8 min-w-[720px] max-w-[900px] mx-auto">
  <div class="flex items-center justify-between mb-6">
    <h2 class="text-white text-2xl font-bold">Setlist - {{ concert.artist.name }}</h2>
    <div class="text-sm text-[#92a4c9]">{{ concert.venue.name }} · {{ concert.start_datetime|date:"d/m/Y" }}</div>
  </div>

  {% if user.is_staff %}
    <div class="mb-6">
      <a href="{% url 'setlistentry_add' concert_pk=concert.pk %}" class="inline-flex items-center gap-2 bg-primary text-white px-4 py-2 rounded shadow hover:opacity-95">
        <span class="material-symbols-outlined">add</span> Agregar entrada
      </a>
    </div>
  {% endif %}

  {% if setlist_entries %}
    <div class="space-y-3">
      {% for entry in setlist_entries %}
        <div class="bg-[#0f1724] border border-[#1f2a44] rounded-lg p-4 flex items-start justify-between shadow-sm">
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 flex items-center justify-center bg-[#162033] text-white rounded-md font-semibold">{{ entry.position }}</div>
            <div>
              <div class="text-white text-lg font-medium">{{ entry.song.title }}</div>
              <div class="text-sm text-[#92a4c9] mt-1">
                {% if entry.section %}Sección: {{ entry.section }} · {% endif %}
                {% if entry.song.original_artist %}
                  {{ entry.song.original_artist.name }}
                {% elif entry.song.original_artist_name %}
                  {{ entry.song.original_artist_name }}
                {% endif %}
              </div>
            </div>
          </div>
          {% if user.is_staff %}
            <div class="flex items-center gap-3">
              <a href="{% url 'setlistentry_edit' pk=entry.pk %}" class="inline-flex items-center gap-2 px-3 py-1 bg-[#1b2a44] text-[#92a4c9] rounded hover:bg-[#21324a]">
                <span class="material-symbols-outlined">edit</span>
                <span class="text-sm">Editar</span>
              </a>
              <form method="post" action="{% url 'setlistentry_delete' pk=entry.pk %}" class="inline-block">
                {% csrf_token %}
                <button type="submit" class="inline-flex items-center gap-2 px-3 py-1 bg-transparent text-red-400 rounded hover:bg-[#2a1b1b]">
                  <span class="material-symbols-outlined">delete</span>
                  <span class="text-sm">Borrar</span>
                </button>
              </form>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="bg-[#0f1724] border border-dashed border-[#243048] rounded-lg p-6 text-center">
    {% if user.is_staff %}
      <p class="text-[#92a4c9]">No hay canciones en el setlist todavía. Usa "Agregar entrada" para comenzar.</p>
    {% else %}
      <p class="text-[#92a4c9]">No hay canciones en el setlist todavía.</p>
    </div>
    {% endif %}
  {% endif %}
  <div class="mt-6">
    <a href="{% url 'concert_list' %}" class="text-primary hover:underline">Volver a Conciertos</a>
  </div>
</div>
{% endblock %}
